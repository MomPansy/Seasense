# Load nvm if available
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"

npm run build:typecheck

# Run ESLint on staged files only
echo "Running ESLint on staged files..."
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(js|jsx|ts|tsx)$' || true)

if [ -n "$STAGED_FILES" ]; then
  echo "Linting: $STAGED_FILES"
  npx eslint $STAGED_FILES --max-warnings=0 --fix || exit 1
  npx prettier $STAGED_FILES --write || exit 1
  git add $STAGED_FILES
else
  echo "No JavaScript/TypeScript files to lint."
fi
